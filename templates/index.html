<html>
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script
      type="text/javascript"
      src="https://code.jquery.com/jquery-1.7.1.min.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.24.0/moment.min.js"></script>
    <style>
      body {
        background-color: rgb(16, 20, 29);
        color: white;
      }

      .greeting {
        overflow: hidden;
        font-weight: bold;
        font-size: 36px;
        line-height: 1.3;
        letter-spacing: 5px;
        background-image: linear-gradient(
          -45deg,
          #fff 20%,
          #6355a4 40%,
          #e89a3e 60%,
          #fff 80%
        );
        background-size: auto auto;
        background-clip: border-box;
        background-size: 200% auto;
        color: #fff;
        background-clip: text;
        text-fill-color: transparent;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: typing 3.5s steps(40, end), textclip 3s linear infinite;
        white-space: nowrap;
        bottom: 60px;
      }

      @keyframes typing {
        from {
          width: 0;
        }
        to {
          width: 100%;
        }
      }
      @keyframes textclip {
        to {
          background-position: 100% center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row" style="text-align: center; margin-top: 50px">
        <h2 class="greeting">HOUSE PRICE PREDICTION</h2>
      </div>
      <div class="row g-3">
        <div class="col g-3 d-flex justify-content-center">
          <form id="predictForm" class="row g-3" style="width: 60%">
            <div class="col-md-6">
              <label for="selectDistrict" class="form-label">District</label>
              <select class="form-select" id="selectDistrict">
                <option selected>Quận 1</option>
                <option value="1">Quận 2</option>
                <option value="2">Quận 3</option>
                <option value="3">Quận 4</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="inputCity" class="form-label">City</label>
              <input
                value="Thành Phố Hồ Chí Minh"
                type="text"
                class="form-control"
                id="inputCity"
                disabled
              />
            </div>
            <div class="col-12">
              <label for="inputAddress" class="form-label">Address</label>
              <input
                type="text"
                class="form-control"
                id="inputAddress"
                placeholder="1234 Main St"
                required
              />
            </div>
            <div class="col-md-6">
              <label for="inputArea" class="form-label">Area (m2) </label>
              <input
                type="number"
                class="form-control"
                id="inputArea"
                placeholder="34"
              />
            </div>
            <div class="col-md-6">
              <label for="inputDateSubmit" class="form-label">
                Date Prediction
              </label>
              <input
                type="date"
                class="form-control"
                id="inputDateSubmit"
                data-date-format="DD MMMM YYYY"
              />
            </div>
            <div class="col-md-12">
              <div id="predictBtn" class="btn btn-success" style="width: 100%">
                Predict
              </div>
            </div>
            <div id="price" class="col-md-12">Price:</div>
          </form>
        </div>
      </div>
      <div class="row g-3">
        <div class="col-md-6 g-3 d-flex justify-content-center">
          <canvas id="myChart"></canvas>
        </div>
      </div>
    </div>
  </body>
  <script>
    const codeHCM = 79;
    $(document).ready(function () {
      districts = fetchDistricts(codeHCM);
      var date = moment().format("YYYY MM DD");
      $("#inputDateSubmit").val(date.split(" ").join("-"));
    });

    $(document).ready(function () {
      $("#predictBtn").click(function () {
        const data = {
          district: $("#selectDistrict option:selected").text(),
          area: Number($("#inputArea").val()),
          dateSubmit: $("#inputDateSubmit").val(),
          address: $("#inputAddress").val(),
        };
        fetch(data);
      });
    });

    function fetch({ district, area, dateSubmit, address }) {
      $.ajax({
        url: `./price/?district=${district}&&area=${area}&&address=${address}&&dateSubmit=${dateSubmit}`,
        type: "GET",
        dataType: "JSON",
        data: JSON.stringify({}),
        success: function (data) {
          console.log(data);
        },
      });
    }

    function fetchDistricts(codeProvince) {
      let districts;
      $.ajax({
        url: `https://vapi.vnappmob.com/api/province/district/${codeProvince}`,
        type: "GET",
        dataType: "JSON",
        data: JSON.stringify({}),
        success: function (data) {
          console.log(data);
          districts = data;
        },
      });
      return districts;
    }

    function fetchWards(codeDistrict) {
      let wards;
      $.ajax({
        url: `https://vapi.vnappmob.com/api/province/ward/${codeDistrict}`,
        type: "GET",
        dataType: "JSON",
        data: JSON.stringify({}),
        success: function (data) {
          console.log(data);
          wards = data;
        },
      });
      return wards;
    }
  </script>
  <script>
    const ctx = document.getElementById("myChart");

    new Chart(ctx, {
      type: "bar",
      data: {
        labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
        datasets: [
          {
            label: "# of Votes",
            data: [12, 19, 3, 5, 2, 3],
            borderWidth: 1,
          },
        ],
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
          },
        },
      },
    });
  </script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"
  ></script>
</html>
